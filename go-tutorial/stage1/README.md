# Go Tutorial Stage 1

## Build with Bazel

Start in the `stage1` directory, where we'll find a program. We can build it with bazel build, then run it:

```sh
cd go-tutorial/stage1/
bazel build //:hello
```

```sh
bazel-bin/hello_/hello
Hello, Bazel! ðŸ’š
```

We can also build run the program with a single `bazel run` command:

```sh
bazel run //:hello
```

### Understanding project structure

`hello.go` contains the Go source code for the program.

`BUILD` contains some instructions for Bazel, telling it what we want to build. For this project, we have a single `go_binary` target that builds our program from `hello.go`.

```bazel
load("@rules_go//go:def.bzl", "go_binary")

go_binary(
    name = "hello",
    srcs = ["hello.go"],
)
```

`MODULE.bazel`

- tracks your project's dependencies
- also marks your project's root directory
- so only write one `MODULE.bazel` file per project.

It serves a similar purpose to Go's `go.mod` file. You don't actually need a
`go.mod` file in a Bazel project, but it may still be useful to have one so that
you can continue using `go get` and `go mod tidy` for dependency management. The
Bazel Go rule set can import dependencies from `go.mod`.

Our `MODULE.bazel` file contains a single dependency on
[rules_go](https://github.com/bazel-contrib/rules_go), the Go rule set. We need
this dependency because Bazel doesn't have built-in support for Go.

```bazel
bazel_dep(
    name = "rules_go",
    version = "0.50.1",
)
```

Finally, `MODULE.bazel.lock` is a file generated by Bazel that contains hashes
and other metadata about our dependencies. It includes implicit dependencies added by Bazel itself, so it's quite long. Just like `go.sum`, you should commit your `MODULE.bazel.lock` file to source control to ensure everyone on your project gets the same version of each dependency. You shouldn't edit `MODULE.bazel.lock` manually.

### Understand the BUILD file

Most of your interaction with Bazel will be through `BUILD` files (or
equivalently, `BUILD.bazel` files).
`BUILD` files are written in a scripting language called
[Starlark](https://bazel.build/rules/language), a limited subset of Python.

A `BUILD` file contains a list of
[targets](https://bazel.build/reference/glossary#target). A target is something
Bazel can build, like a binary, library, or test.

A target calls a rule function with a list of
[attributes](https://bazel.build/reference/glossary#attribute) to describe what
should be built. Our example has two attributes: `name` identifies the target on
the command line, and `srcs` is a list of source file paths (slash-separated,
relative to the directory containing the `BUILD` file).

A [rule](https://bazel.build/reference/glossary#rule) tells Bazel how to build a
target. In our example, we used the
[`go_binary`](https://github.com/bazel-contrib/rules_go/blob/master/docs/go/core/rules.md#go_binary)
rule. Each rule defines [actions](https://bazel.build/reference/glossary#action)
(commands) that generate a set of output files. For example, `go_binary` defines
Go compile and link actions that produce an executable output file.
